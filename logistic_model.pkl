
import pandas as pd
from sklearn.linear_model import LogisticRegression
import pickle

# Load the Titanic dataset
train_data = pd.read_csv('Titanic_train.csv')

# Data preprocessing
# Drop columns that are not useful for model building
train_data = train_data.drop(['Name', 'Ticket', 'Cabin'], axis=1)

# Fill missing values in 'Age' with median and 'Embarked' with the most common value
train_data['Age'].fillna(train_data['Age'].median(), inplace=True)
train_data['Embarked'].fillna(train_data['Embarked'].mode()[0], inplace=True)

# Convert categorical features to numeric using one-hot encoding
train_data = pd.get_dummies(train_data, columns=['Sex', 'Embarked'], drop_first=True)

# Split the data into features and target
X = train_data.drop('Survived', axis=1)
y = train_data['Survived']

# Build the logistic regression model
model = LogisticRegression(max_iter=1000)
model.fit(X, y)

# Save the model to a file
with open('logistic_model.pkl', 'wb') as file:
    pickle.dump(model, file)
